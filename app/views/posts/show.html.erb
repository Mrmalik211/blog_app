<%= link_to 'Back to Home', root_path,class: 'btn btn-secondary active' %><br><br>

<h1><%= @post.title %></h1>

<% if @post.image.attached? %>
  <%= link_to image_tag(@post.image ,class: 'img-fluid img-thumbnail', width: '40%') %>
<% else %>
  <%= link_to image_tag('image_not.jpg' ,class: 'img-fluid img-thumbnail',width: '40%') %>
<% end %>
<br><br>
<p class='text-muted'><%= @post.description %></p>
<p>Likes : <%= @post.likes %></p>

<%= link_to 'Like', post_path(@post), :locals => { :project_phase => params[:phase] }, onclick: 'like()',                                     class: 'btn btn-primary' %>

<% if user_signed_in? %>
  <% if PostPolicy.new(current_user, @post).edit? %>
    <%= link_to 'Edit Post', edit_post_path(@post) ,class: 'btn btn-primary' %>
    <%= link_to 'Delete Post', @post, method: :delete ,
                                      data: {
                                        turbo_method: :delete,
                                        turbo_confirm: 'Are you sure?'
                                      }, class: 'btn btn-primary' %>
  <% end %>
<% end %>

<br><hr><br>
<h3>Comments</h3>
  <% if @post.comments.any? %>
    <ul>
      <% @post.comments.each do |comment| %>
        <li>
          <%= comment.content %>
          <% if user_signed_in? && (comment.user_id == current_user.id || @post.user_id == current_user.id) %>
            <% if current_user.id == comment.user_id %>
              <%= link_to'Edit', edit_post_comment_path(comment.post,comment),
                                 class: 'btn btn-outline-primary btn-sm' %>
            <% end %>
            <%= link_to "Delete", [comment.post, comment], method: :delete ,data: {
                            turbo_method: :delete,
                            turbo_confirm: 'Are you sure?'
                          } ,class: 'btn btn-outline-primary btn-sm' %>
          <% end %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>No Comments!</p><br><br>
  <% end %>


<h5>Add a comment:</h5>
<%= render '/comments/form', post: @post, comment: @post.comments.build %>


